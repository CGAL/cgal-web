

<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>New in CGAL: Resolving Self-Intersections in a Surface Mesh, now with Snap Rounding</title>
    <meta name="description" content="">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <meta name="author" content="CGAL Editorial Board">

    <link rel="icon" type="image/png" href="/cgal-web/images/cgal_logo/g-196x196-y.png">
    <link rel="stylesheet" href="/cgal-web/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/cgal-web/node_modules/bootstrap-icons/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/cgal-web/node_modules/bxslider/dist/jquery.bxslider.css">
    <link rel="stylesheet" href="/cgal-web/style.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,600,800' rel='stylesheet' type='text/css'>

    <!--[if lte IE 8]>
	<link rel="stylesheet" href="css/leaflet.ie.css" />
	<![endif]-->
    <link rel="stylesheet" href="/cgal-web/assets/themes/cgal/main.css">

    <!-- atom & rss feed -->
    <link href="/cgal-web/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/cgal-web/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>
  <body>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
    

    <!-- Navigation & Logo-->
    <div class="mainmenu-wrapper">
    <div class="container">
    <div class="mobile-header">
      <a href="/cgal-web/index.html" class="mobile-logo">
        <img src="/cgal-web/images/cgal_front_page_2013.png" alt="CGAL Logo" height="30">
      </a>
      <button class="menu-toggle" aria-label="Menu">
        Menu
      </button>
    </div>
    <nav id="mainmenu" class="mainmenu" role="navigation">
    <ul>
    <li class="logo-wrapper hidden-xs hidden-sm hidden-md">
    <a href="/cgal-web/index.html">
    <img src="/cgal-web/images/cgal_front_page_2013.png" alt="CGAL Logo" width="250px">
    </a>
    </li>

    <li class="hidden-lg">
    <a href="/cgal-web/index.html">
    <img src="/cgal-web/images/cgal_front_page_2013.png" alt="CGAL Logo" height="20px">
    </a>
    </li>

    <li>
    <a href="/cgal-web/project.html">Project</a>
    </li>

    <li>
    <a href="/cgal-web/download.html">Download</a>
    </li>

    <li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">Packages</a>
        <ul class="dropdown-menu">
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartAlgebraicFoundations" target="_blank">Arithmetic and Algebra</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartCombinatorialAlgorithms" target="_blank">Combinatorial Algorithms</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartKernels" target="_blank">Geometry Kernels</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartConvexHullAlgorithms" target="_blank">Convex Hull Algorithms</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartPolygons" target="_blank">Polygons</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartPolyhedra" target="_blank">Cell Complexes and Polyhedra</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartArrangements" target="_blank">Arrangements</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartTriangulationsAndDelaunayTriangulations" target="_blank">Triangulations</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartVoronoiDiagrams" target="_blank">Voronoi Diagrams</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartMeshing" target="_blank">Mesh Generation</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartReconstruction" target="_blank">Shape Reconstruction</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartGeometryProcessing" target="_blank">Geometry Processing</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartSearchStructures" target="_blank">Spatial Searching</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartGeometricOptimization" target="_blank">Geometric Optimization</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartInterpolation" target="_blank">Interpolation</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartSupportLibrary" target="_blank">Support Library</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartVisualization" target="_blank">Visualization</a></li>
        </ul>
    </li>

    <li>
    <a href="/cgal-web/documentation.html">Documentation</a>
    </li>

    <li>
    <a href="/cgal-web/news.html">News</a>
    </li>

    <li>
    <a href="/cgal-web/media.html">Media</a>
    </li>

    <li>
    <a href="/cgal-web/support.html">Support</a>
    </li>

    </ul>
        </nav>
      </div>
    </div>

    <div class="section section-breadcrumbs">
      <div class="container">
        <div class="row">
          <div class="col-md-12 home-title">
            <h1>New in CGAL: Resolving Self-Intersections in a Surface Mesh, now with Snap Rounding </h1>
            <a style="text-align: right;" href="https://github.com/cgal/cgal" alt="The CGAL Project's github">
              <span class="btn-dark-orange github-link fs-5">CGAL/cgal <i class="bi bi-github"></i></span>
            </a>
          </div>
        </div>
      </div>
    </div>
    
    

<div class="section">
  <div class="container">
    <div class="row">

      <div class="col-sm-9">
        <div class="blog-post blog-single-post">
          <div class="single-post-title">
            <h3>New in CGAL: Resolving Self-Intersections in a Surface Mesh, now with Snap Rounding</h3>
          </div>
          <br>
          <div class="single-post-info">
            <i class="bi bi-clock"></i>
            13 June 2025
          </div>
          <div class="single-post-content">
            
<h3><a href="https://geometryfactory.com/who-we-are/">Sébastien Loriot</a>&#42; &amp; <a href="https://geometryfactory.com/who-we-are/">Léo Valque</a>&#42;</h3>
<h4>&#42;<a href="https://geometryfactory.com/">GeometryFactory</a></h4>

<p><br /></p>
<h3>3D Boolean Operations in CGAL: a Primer</h3>

<p>In December 2004, CGAL 3.1 was released with the package <a href="https://doc.cgal.org/latest/Nef_3">3D Boolean Operations on Nef Polyhedra</a>
It provided a robust way to compute Boolean Operations on Nef Polyhedra. In particular, it allows users to do some Boolean operations
on solids bounded by surface meshes, but also on models with non-manifold features and 1D features. Even today, this package is probably
the only one in the open source world to allow this kind of operations. All this genericity comes at a price. Indeed the algorithm used
needs to compute and maintain an arrangement of circles on a sphere at each vertex of the Nef Polyhedra in order to enable those operations.
This representation also requires that the intersection points computed are coplanar with the polygongal faces they describe, implying the
use of a Kernel with exact constructions.</p>

<p>As all this genericity is not required for all applications, we decided to work on an alternative method that would be restricted to solids
being bounded by triangle meshes, and such that the output is manifold. In October 2012, we released an undocumented version of a new code
based of corefinement of triangles meshes. With the feedback of early adopters, we officially released with CGAL 4.10 in May 2017 inside
the <a href="https://doc.cgal.org/latest/Polygon_mesh_processing">Polygon Mesh Processing</a> package a rewrite of the original 3D Boolean operations through
corefinement. One of the key features of this code is the ability to compute several type of operations in one run (union and intersection
for example), and the possibility to store the result in a new mesh or directly update one of the input meshes to avoid recopying the entire
mesh if only a small portion is affected. When it comes to robustness, exact constructions are used under the hood to guarantee an output
with the correct topology. To show the robustness and the speed of the method, we posted a <a href="https://www.linkedin.com/pulse/benchmarking-mesh-union-using-cgal-libigl-sebastien-loriot/">benchmark</a>
on the <a href="https://ten-thousand-models.appspot.com/">Thingi10k data set</a> testing the code on thousands of models.</p>

<p>A question that was often asked by users was the possibility to use that code to resolve self-intersections in triangle meshes
and more particularly in solids. This gave us the idea to modify the corefinement code to write an autorefinement version
that would refine triangles from the same mesh that are intersecting along segments not in the input. Then, using those intersection
edges apply a self-union to resolve self-intersections of the solid.
</p>

<p><br /></p>
<div style="text-align:center;">
  <a href="../../../../images/cylinder_autorefine.png"><img src="../../../../images/cylinder_autorefine.png" style="max-width:95%" /></a>
  <br /><small>Left: A triangle mesh genererated by sweeping a circle along a spiral curve;
             Right: A triangle mesh free from self-intersection bounding the same volume as in the left picture;
             On the bottom, we see the intersection curve of a plane with the triangle meshes.</small>
</div>

<p>In CGAL 4.11 (April 2018), we released an undocumented version of this autorefinement code. The code was however limited to
meshes where only pairs of triangles were intersecting along the same segment (as an underlying requirement of the code is
a pairwise intersection). In order to officially release that code, we needed to over come this limitation. Over the years,
we have tried to improve the code but we were limited by the notion of pairwise intersection.
As a new year resolution, on the 2nd of January 2023 we started a new from scratch implementation of an autorefinement
code of triangle soups, that was officially release in September 2024 with CGAL 6.0 (CGAL 5.6 being released in July 2023
we could not match the feature freeze of April even if the code was already working).</p>

<h3>A Robust and Fast Method to Resolve Intersections in Triangle Soups</h3>

<p>The function <a href="https://doc.cgal.org/6.0/Polygon_mesh_processing/group__PMP__corefinement__grp.html#gaec85370aa0b2acc0919e5f8406cfb74c">CGAL::Polygon_mesh_processing::autorefine_triangle_soup()</a>
takes as input a triangle soup (a range of points and a range of triple of integers representing triangles using points indices), and resolves all
intersections among the triangles by refining the triangles no triangle intersects but along a shared edge or a shared vertex. The function operates
on a triangle soup and not a triangle mesh to be able to handle all kind of nasty input (including degenerate faces and non-manifoldness), but
also to be able to get non-manifold output. Indeed, even for two triangles intersecting along a line, after refining them to resolve the intersection
you end up with four triangles sharing the same edge.

In order to show the robustness and the runtime efficiency of the function, we ran it over all 10,000 models from the Thingi10k repository.
The computer used for the benchmark runs a x86_64 Debian GNU/Linux 6.1.0-12-amd64 and features a 2016 Intel(R) Xeon(R) CPU E5-1650 v4 @ 3.60GHz with 6 threads/12 hyperthreads.
The values of memory are the maximum resident set size (given using `/usr/bin/time` command).

<br />
<div style="text-align:center;">
  <a href="../../../../images/autoref_runtime.png"><img src="../../../../images/autoref_runtime.png" style="max-width:95%" /></a>
</div>
</p>
<p><br /></p>
<div style="text-align:center;">
  <a href="../../../../images/autoref_mem.png"><img src="../../../../images/autoref_mem.png" style="max-width:95%" /></a>
</div>
<p>&lt;/p&gt;</p>

<p>Even if exact computations are used internally, if the input is using double coordinates, then the output point coordinates are also rounded to double coordinates.
As a matter of fact, this naive rounding to double implies that out the 9997 valid input files, only 9425 were free from self-intersection after autorefine and naive rounding.
So we are left with 572 files still featuring self-intersections while the purpose of calling the autorefine function was to resolve them.</p>

<p><br /></p>
<h3>A New Snapping Strategy</h3>

<p>
Based on `[1]`, CGAL 6.1 introduces the new parameter `apply_iterative_snap_rouding()` to the autorefine function to activate a snapping strategy in order
to avoid self-intersections produced while rounding the coordinates to double.
With the default values of the parameters for this method, all the models but one could be rounded with one call.
The remaining model required a few more iterations.

<br />
<div style="text-align:center;">
  <a href="../../../../images/XXX.png"><img src="../../../../images/XXX.png" style="max-width:95%" /></a>
  <br /><small>Blabla</small>
</div>
TODO: the graph
</p>

<p>The main idea behind the method is a loop that rounds coordinates of triangles involved in a self-intersections onto a floating point number type, eliminate degenerate
elements, and resolve again the self-intersections, until a maximum number of iterations is reached or all self-intersections are resolved.
Even if there is no theoretical guarantee for successful termination, it has good experimental results.</p>

<p><br /></p>
<h4>Status</h4>

<p>All methods are already integrated in CGAL's master branch on the
<a href="https://github.com/CGAL/cgal/">CGAL GitHub repository</a> and
will be officially released in the upcoming version of CGAL, CGAL 6.1, scheduled for summer 2025.</p>

<p><i class="bi bi-book"></i>
<a href="https://cgal.geometryfactory.com/CGAL/doc/master/Polygon_mesh_processing/group__PMP__corefinement__grp.html#ga5dc9e7acf8433235adc7b91ac93a7d42">Documentation of the function <em>CGAL::Polygon_mesh_processing::clip()</em></a>
<br />
<i class="bi bi-arrow-down-circle"></i>
<a href="https://github.com/CGAL/cgal/tree/master">CGAL master branch on GitHub</a>
<br /><br /></p>

<h4>Bibliography</h4>
<p><code class="language-plaintext highlighter-rouge">[1]</code> Sylvain Lazard and Leo Valque. Removing self-intersections in 3D meshes while preserving floating-point coordinates. working paper or preprint, January 2025.</p>

          </div>
        </div>
      </div>

      <div class="col-sm-3 blog-sidebar">
        <h4>Recent Posts</h4>
        <ul class="recent-posts">
          
            
            
            <li class="active"><a href="/cgal-web/2025/06/13/autorefine-and-snap/" class="active">New in CGAL: Resolving Self-Intersections in a Surface Mesh, now with Snap Rounding</a>
            <br><div style="font-size:12px">June 2025</div></li>
          
            
            
            <li class="active"><a href="/cgal-web/2025/06/06/new_clip/" class="active">New in CGAL: Improved Surface Mesh Clipping</a>
            <br><div style="font-size:12px">June 2025</div></li>
          
            
            
            <li class="active"><a href="/cgal-web/2025/05/22/Surface_remeshing/" class="active">New in CGAL: New Surface Remeshing Algorithms</a>
            <br><div style="font-size:12px">May 2025</div></li>
          
            
            
            <li class="active"><a href="/cgal-web/2025/05/22/Polygon_repair/" class="active">New in CGAL: Polygon Repair</a>
            <br><div style="font-size:12px">May 2025</div></li>
          
        </ul>
        <a href="/cgal-web/news.html" class="btn">Older posts...</a>
      </div>
    </div>
  </div>
</div>


    
    <!-- Footer -->
    <div class="footer">
      <div class="container">
        <div class="col-md-12">
          <div class="footer-copyright">
            <div style="float: left;">
              <a href="https://twitter.com/TheCGALProject" alt="The CGAL Project's Twitter">
                <img src="/cgal-web/images/icons/twitter.svg" class="center-block btn-dark-orange" alt="Twitter" height="18"></img>
              </a>
            </div>
            &copy; 1995-2025 The CGAL Project. All rights reserved.
            <div style="float: right;">
              <a href="https://cgal.geometryfactory.com/CGAL/Members/wiki/Main_Page" alt="Password protected access to the Developer Wiki">
                <i class="bi bi-file-lock fs-5"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Javascripts -->
    <script src="/cgal-web/node_modules/jquery/dist/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/cgal-web/node_modules/jquery/dist/jquery.min.js"><\/script>')</script>
      <script src="/cgal-web/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
      <script src="/cgal-web/node_modules/bxslider/dist/jquery.bxslider.min.js"></script>
      <script>
        $(function () {
          $('.bxslider').bxSlider({
            auto: true,
            speed: 0,
            pause: 5000,
            infiniteLoop: true,
            touchEnabled: false,
            pager: true,
            pagerCustom: '.custom-pager',
            controls: false,
            onSliderLoad: function (currentIndex) {
              $('.bxslider li').find('.slideTitle, .slideSubTitle').css({
                transform: 'translate(0)',
                opacity: 1
              });
              $('.bxslider li').eq(currentIndex).find('.slideTitle, .slideSubTitle').addClass('animatedTitle');
            },
            onSlideBefore: function ($slideElement, oldIndex, newIndex) {
              $($slideElement).siblings().find('.slideTitle, .slideSubTitle').removeClass('animatedTitle');
              $($slideElement).find('.slideTitle, .slideSubTitle').addClass('animatedTitle');
              $($slideElement).siblings().find('.slide').removeClass('slideInFromRight');
              $($slideElement).find('.slide').addClass('slideInFromRight');
            }
          });
        });

        document.addEventListener('DOMContentLoaded', function() {
          const menuToggle = document.querySelector('.menu-toggle');
          const mainMenu = document.getElementById('mainmenu');

          menuToggle.addEventListener('click', function() {
              mainMenu.classList.toggle('active');
              menuToggle.classList.toggle('active');
          });
      });
      </script>
      <script src="/cgal-web/node_modules/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js"></script>
    </body>
</html>

