---
layout: post
title: "New in CGAL: New Implementation of Surface Mesh Clipping"
description: ""
category:
tags: [""]
---
{% include JB/setup %}

<h3><a href="https://geometryfactory.com/who-we-are/">SÃ©bastien Loriot</a>&#42;</h3>
<h4>&#42;<a href="https://geometryfactory.com/">GeometryFactory</a></h4>

<br>
<p>Several releases ago, CGAL shipped the function <a href="https://doc.cgal.org/latest/Polygon_mesh_processing/group__PMP__corefinement__grp.html#ga88ea5360f9fe65458f9086b453447662">CGAL::Polygon_mesh_processing::clip()</a>
that allows the user to restrict the volume bounded by a triangle mesh to a halfspace defined by an oriented plane. This operations is often called clip.
Over the releases, this function has been extended to also clip surfaces represented by triangle meshes with boundaries, as well as self-intersecting surfaces.
The original implementation was a by product of the function <a href="https://doc.cgal.org/latest/Polygon_mesh_processing/group__PMP__corefinement__grp.html#ga3ff96d36cad8f37efcdada916c46fbbe">CGAL::Polygon_mesh_processing::corefine_and_compute_intersection()</a>.
The code was working well but with several drawbacks:
 - the clipping plane was actually represented by a triangle mesh of the enlarged bounding box of the input mesh, clipped with the input plane.
   This lead to extra vertices in the output.
 - the code was restricted to input triangle meshes
 - the code was not taking advantage at of of the fact that the clipper is a plane

With CGAL 6.1, we will release a new from scratch implementation fixing all those drawbacks, without changing the API.
</p>

<div style="text-align:center;">
  <a href="../../../../images/clip_ex.png"><img src="../../../../images/clip_ex.png" style="max-width:95%"/></a>
  <br><small>Iterative plane clipping of a surface mesh of the elephant.</small>
</div>

<p>
|                            | Input     | 1st clip  | 2nd clip  | 3rd clip | 4th clip |
| ---------------------------|  -------  | --------- | --------- | -------- | -------- |
| Number of faces (CGAL 6.1) | 1,422,848 | 743,276   | 170,652   | 113,425  | 55,245   |
| Runtime in s.(CGAL 6.1)    |    -      | 0.19656   | 0.12051   | 0.04491  | 0.03605  |
| Number of faces (CGAL 6.0) | 1,422,848 | 749,714   | 173,542   | 116,520  | 58,800   |
| Runtime in s. (CGAL 6.0)   |    -      | 2.71621   | 0.87903   | 0.60735  | 0.36834  |

The runtimes and numbers of faces for CGAL 6.1 are given when the resulting clipped mesh is not triangulated.
Below you can see the final output not trianguled of CGAL 6.1 vs. that of CGAL 6.0:

<div style="text-align:center;">
  <a href="../../../../images/clip_with_edges.png"><img src="../../../../images/clip_with_edges.png" style="max-width:95%"/></a>
  <br><small>Output of CGAL 6.1 vs output of CGAL 6.0.</small>
</div>

</p>


<p>The implementation is internally using the new in CGAL 6.1 function
<a href="https://cgal.geometryfactory.com/CGAL/doc/master/Polygon_mesh_processing/group__PMP__corefinement__grp.html#gacb9d68fa4dea8fd03ec53b56a16d6fc6">CGAL::Polygon_mesh_processing::refine_with_plane()</a>
that inserts in an input surface mesh the intersection edges of an input plane and provides an access to the created intersection edges.
</p>

<div style="text-align:center;">
  <a href="../../../../images/refine_with_planes.png"><img src="../../../../images/refine_with_planes.png" style="max-width:95%"/></a>
  <br><small>Triangle mesh with intersection edges of planes of a regular grids, (not triangulated on the left)Output of CGAL 6.1 vs output of CGAL 6.0.</small>
</div>

<h4>Status</h4>

<p>All these additions already are integrated in CGAL's master branch on the
<a href="https://github.com/CGAL/cgal/">CGAL GitHub repository</a> and
will be officially released in the upcoming version of CGAL, CGAL 6.1, scheduled for mid 2025.</p>
