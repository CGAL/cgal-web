

<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Mesh_3 improvements</title>
    <meta name="description" content="Mesh_3 improvements in CGAL-6.0">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <meta name="author" content="CGAL Editorial Board">

    <link rel="icon" type="image/png" href="https://cgal.github.io/cgal-web/images/cgal_logo/g-196x196-y.png">
    <link rel="stylesheet" href="https://cgal.github.io/cgal-web/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cgal.github.io/cgal-web/node_modules/bootstrap-icons/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cgal.github.io/cgal-web/node_modules/bxslider/dist/jquery.bxslider.css">
    <link rel="stylesheet" href="https://cgal.github.io/cgal-web/style.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,600,800' rel='stylesheet' type='text/css'>

    <!--[if lte IE 8]>
	<link rel="stylesheet" href="css/leaflet.ie.css" />
	<![endif]-->
    <link rel="stylesheet" href="https://cgal.github.io/cgal-web/assets/themes/cgal//main.css">

    <!-- atom & rss feed -->
    <link href="https://cgal.github.io/cgal-web/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="https://cgal.github.io/cgal-web/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>
  <body>
    <!--[if lt IE 7]>
        <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->
    

    <!-- Navigation & Logo-->
    <div class="mainmenu-wrapper">
    <div class="container">
    <nav id="mainmenu" class="mainmenu" role="navigation">
    <ul>
    <li class="logo-wrapper hidden-xs hidden-sm hidden-md">
    <a href="https://cgal.github.io/cgal-web/index.html">
    <img src="https://cgal.github.io/cgal-web/images/cgal_front_page_2013.png" alt="CGAL Logo" width="250px">
    </a>
    </li>

    <li class="hidden-lg">
    <a href="https://cgal.github.io/cgal-web/index.html">
    <img src="https://cgal.github.io/cgal-web/images/cgal_front_page_2013.png" alt="CGAL Logo" height="20px">
    </a>
    </li>

    <li>
    <a href="https://cgal.github.io/cgal-web/project.html">Project</a>
    </li>

    <li>
    <a href="https://cgal.github.io/cgal-web/download.html">Download</a>
    </li>

    <li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">Packages</a>
        <ul class="dropdown-menu">
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartAlgebraicFoundations" target="_blank">Arithmetic and Algebra</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartCombinatorialAlgorithms" target="_blank">Combinatorial Algorithms</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartKernels" target="_blank">Geometry Kernels</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartConvexHullAlgorithms" target="_blank">Convex Hull Algorithms</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartPolygons" target="_blank">Polygons</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartPolyhedra" target="_blank">Cell Complexes and Polyhedra</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartArrangements" target="_blank">Arrangements</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartTriangulationsAndDelaunayTriangulations" target="_blank">Triangulations</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartVoronoiDiagrams" target="_blank">Voronoi Diagrams</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartMeshing" target="_blank">Mesh Generation</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartReconstruction" target="_blank">Shape Reconstruction</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartGeometryProcessing" target="_blank">Geometry Processing</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartSearchStructures" target="_blank">Spatial Searching</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartGeometricOptimization" target="_blank">Geometric Optimization</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartInterpolation" target="_blank">Interpolation</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartSupportLibrary" target="_blank">Support Library</a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="https://doc.cgal.org/latest/Manual/packages.html#PartVisualization" target="_blank">Visualization</a></li>
        </ul>
    </li>

    <li>
    <a href="https://cgal.github.io/cgal-web/documentation.html">Documentation</a>
    </li>

    <li>
    <a href="https://cgal.github.io/cgal-web/news.html">News</a>
    </li>

    <li>
    <a href="https://cgal.github.io/cgal-web/media.html">Media</a>
    </li>

    <li>
    <a href="https://cgal.github.io/cgal-web/support.html">Support</a>
    </li>

    </ul>
        </nav>
      </div>
    </div>

    <div class="section section-breadcrumbs">
      <div class="container">
        <div class="row">
          <div class="col-md-12 home-title">
            <h1>Mesh_3 improvements </h1>
            <a style="text-align: right;" href="https://github.com/cgal/cgal" alt="The CGAL Project's github">
              <span class="btn-dark-orange github-link fs-5">CGAL/cgal <i class="bi bi-github"></i></span>
            </a>
          </div>
        </div>
      </div>
    </div>
    
    

<div class="section">
  <div class="container">
    <div class="row">

      <div class="col-sm-9">
        <div class="blog-post blog-single-post">
          <div class="single-post-title">
            <h3>Mesh_3 improvements</h3>
          </div>
          <br>
          <div class="single-post-info">
            <i class="bi bi-clock"></i>
            05 July 2024
          </div>
          <div class="single-post-content">
            
<h3><a href="https://geometryfactory.com/who-we-are/">Jane Tournois</a></h3>
<h4><a href="http://www.geometryfactory.com" target="_blank">GeometryFactory</a></h4>

<p><br /></p>
<p>Introduced in CGAL 3.5, the package
<a href="https://doc.cgal.org/latest/Manual/packages.html#PkgMesh3" text="3D Mesh Generation">3D Mesh Generation</a>
is designed to generate a isotropic simplicial meshes discretizing 3D domains.
Since then, multiple improvements in mesh quality, performances, and versatility have been made available in CGAL.
Lately, CGAL authors have focused more on the quality of the output mesh, the ability of the
mesh generation algorithm to represent the input surface in a more accurate way, for a wider range of input data types.
</p>

<!--
<div style="text-align:center;">
  <a href="../../../../images/christmas_wrap.png"><img src="../../../../images/christmas_wrap.png" style="max-width:95%"/></a><br>
  <br><small>Season's wrappings.</small>
</div>
-->

<p><br /><br /></p>
<p>Recent releases of CGAL have introduced improvements to the 3D Tetrahedral Mesh Generation package:
detection and protection of triple lines from labeled images,
use of weighted labeled images,
dealing with self-intersecting input surfaces,
and a new approximation error criterion for polyline features.</p>

<p><br /></p>
<h3>Triple lines from labeled images</h3>

<p>CGAL's tetrahedral mesh generation algorithm is able to compute tetrahedral meshes from 3D segmented images.
For all types of inputs, detection and construction of one-dimensional features must be done a priori for the
feature protection algorithm to be able to represent them properly in the generated mesh.
In 3D segmented images, such features correspond to the intersections of the bounding box of the image with the surfaces defined by the image, as well as polylines that lie at the intersection of three or more subdomains (including the outside).</p>

<p>The article
<a href="https://opus4.kobv.de/opus4-zib/frontdoor/index/index/docId/274"><i>Hege, H. C., Seebass, M., Stalling, D., &amp; Zöckler, M. (1997), A generalized marching cubes algorithm based on non-binary classifications</i></a>, provides a list of possible voxel configurations. This description has been generalized for tetrahedral mesh generation needs, and
implemented in CGAL.</p>

<p>After feature lines detection, similarly to what is done for polyhedral surfaces, the polyline features
are added to the feature graph of the domain for feature protection.</p>

<p>Two detection functors are provided :
<ul>
  <li><i>CGAL::Detect_features_in_image()</i>, that detects and constructs all
    polylines lying at the intersection of three or more subdomains, and</li>
  <li><i>CGAL::Detect_features_on_image_bbox()</i>, that detects and constructs the polylines
    that lie at the intersection of two or more subdomains and the bounding box of the input labeled image.</li>
</ul>
</p>

<p><br /></p>
<h3>Weighted Labeled Images</h3>

<p>When a segmented image is given as input for tetrahedral mesh generation,
the generated mesh surface sometimes sticks too closely to the voxels surface, causing an aliasing effect. A solution to generate
a smooth and accurate output surface was described by Stalling et al in
<a href="https://opus4.kobv.de/opus4-zib/frontdoor/index/index/docId/382"><i>Stalling, D., Zöckler, M., Sander, O., &amp; Hege, H. C. (1998), Weighted labels for 3D image segmentation</i></a>.
It consists in generating a second input image, made of integer coefficients called weights, and use those weights to define
smoother domain boundaries. The 3D image of weights can be generated using <i>CGAL::Mesh_3::generate_label_weights()</i>.</p>

<div style="text-align:center;">
  <a href="../../../../images/mesh3_weigthed_images.png"><img src="../../../../images/mesh3_weigthed_images.png" style="max-width:95%" /></a><br />
  <br /><small>Mesh generation from labeled image without weights (left, 88,000 vertices)
   and with weights (right, 67,000 vertices).</small>
</div>

<p><br /></p>
<p>The following example shows how to use weighted labeled images: <a href="https://doc.cgal.org/latest/Mesh_3/Mesh_3_2mesh_3D_weighted_image_8cpp-example.html">mesh_3D_weighted_image.cpp</a>.</p>

<p>Utilizing tetrahedral mesh generation from labeled images, incorporating both feature detection and weighted labels,
presents challenges. A new method that combines feature detection and weighted labels has been
designed and implemented in CGAL, achieving smooth and feature preserving output meshes.
This method leverages the best of these two new functionalities.</p>

<!--
<div style="text-align:center;">
  <a href="../../../../images/volumetric_wrap.png"><img src="../../../../images/volumetric_wrap.png" style="max-width:95%"/></a><br>
  <br><small>Volumetric mesh of the notoriously painful input <a href="https://ten-thousand-models.appspot.com/detail.html?file_id=996816">996816.stl</a> (Thingi10k). 380k cells in ~10s.</small>
</div>
-->

<p><br /></p>
<h3>Self-intersecting input surfaces</h3>

<p><br /></p>
<h3>Approximation Criterion on Feature Edges</h3>

<h3>Status</h3>

<p>All these new improvements are already integrated in CGAL's master branch on the
<a href="https://github.com/CGAL/cgal/">CGAL GitHub repository</a>, and has just been officially released
in the latest version of CGAL, CGAL 6.0-beta1.</p>

<p><i class="bi bi-book"></i>
<a href="https://doc.cgal.org/latest/Manual/packages.html#PkgMesh3">Documentation of the package Mesh_3</a>
<br />
<i class="bi bi-arrow-down-circle"></i>
<a href="https://github.com/CGAL/cgal/tree/master">CGAL master branch on GitHub</a></p>

          </div>
        </div>
      </div>

      <div class="col-sm-3 blog-sidebar">
        <h4>Recent Posts</h4>
        <ul class="recent-posts">
          
            
            
            <li class="active"><a href="https://cgal.github.io/cgal-web/news/2024/07/05/mesh3-improvements/" class="active">Mesh_3 improvements</a>
            <br><div style="font-size:12px">July 2024</div></li>
          
            
            
            <li class="active"><a href="https://cgal.github.io/cgal-web/news/2024/06/21/new-release-cgal6.0-beta1/" class="active">New release 6.0 beta 1</a>
            <br><div style="font-size:12px">June 2024</div></li>
          
            
            
            <li class="active"><a href="https://cgal.github.io/cgal-web/2024/06/21/cgal60-beta1/" class="active">CGAL 6.0 beta1 released</a>
            <br><div style="font-size:12px">June 2024</div></li>
          
            
            
            <li class="active"><a href="https://cgal.github.io/cgal-web/2024/05/29/Kinetic_surface_reconstruction/" class="active">New in CGAL: Kinetic Space Partition and Kinetic Surface Reconstruction</a>
            <br><div style="font-size:12px">May 2024</div></li>
          
        </ul>
        <a href="https://cgal.github.io/cgal-web/news.html" class="btn">Older posts...</a>
      </div>
    </div>
  </div>
</div>


    
    <!-- Footer -->
    <div class="footer">
      <div class="container">
        <div class="col-md-12">
          <div class="footer-copyright">
            <div style="float: left;">
              <a href="https://twitter.com/TheCGALProject" alt="The CGAL Project's Twitter">
                <img src="https://cgal.github.io/cgal-web/images/icons/twitter.svg" class="center-block btn-dark-orange" alt="Twitter" height="18"></img>
              </a>
            </div>
            &copy; 1995-2024 The CGAL Project. All rights reserved.
            <div style="float: right;">
              <a href="https://cgal.geometryfactory.com/CGAL/Members/wiki/Main_Page" alt="Password protected access to the Developer Wiki">
                <i class="bi bi-file-lock fs-5"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Javascripts -->
    <script src="https://cgal.github.io/cgal-web/node_modules/jquery/dist/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="https://cgal.github.io/cgal-web/node_modules/jquery/dist/jquery.min.js"><\/script>')</script>
      <script src="https://cgal.github.io/cgal-web/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
      <script src="https://cgal.github.io/cgal-web/node_modules/bxslider/dist/jquery.bxslider.min.js"></script>
      <script>
        $(function () {
          $('.bxslider').bxSlider({
            auto: true,
            speed: 0,
            pause: 5000,
            infiniteLoop: true,
            touchEnabled: false,
            pager: true,
            pagerCustom: '.custom-pager',
            controls: false,
            onSliderLoad: function (currentIndex) {
              $('.bxslider li').find('.slideTitle, .slideSubTitle').css({
                transform: 'translate(0)',
                opacity: 1
              });
              $('.bxslider li').eq(currentIndex).find('.slideTitle, .slideSubTitle').addClass('animatedTitle');
            },
            onSlideBefore: function ($slideElement, oldIndex, newIndex) {
              $($slideElement).siblings().find('.slideTitle, .slideSubTitle').removeClass('animatedTitle');
              $($slideElement).find('.slideTitle, .slideSubTitle').addClass('animatedTitle');
              $($slideElement).siblings().find('.slide').removeClass('slideInFromRight');
              $($slideElement).find('.slide').addClass('slideInFromRight');
            }
          });
        });
      </script>
      <script src="https://cgal.github.io/cgal-web/node_modules/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js"></script>
    </body>
</html>

